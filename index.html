<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flappy Deluxe</title>
<style>
:root {
  --accent: #ffd166;
  --muted: #64748b;
  --ui: #ffffffcc;
}
* {
  box-sizing: border-box;
  font-family: 'Segoe UI', sans-serif;
  margin: 0;
  padding: 0;
}
body, html {
  height: 100%;
  background: linear-gradient(#9be7ff, #bfeaff);
  overflow: hidden;
}
.page {
  position: absolute;
  inset: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.5s;
}
.page.active {
  opacity: 1;
  pointer-events: auto;
}
button {
  padding: 12px 24px;
  margin: 8px;
  font-weight: 700;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  transition: transform 0.2s;
  background: var(--accent);
}
button:hover {
  transform: scale(1.05);
}
.menu-title {
  font-size: 2rem;
  margin-bottom: 16px;
  color: #fff;
  text-shadow: 0 3px 6px rgba(0,0,0,0.3);
}
.card {
  background: var(--ui);
  padding: 16px;
  border-radius: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
}
#gameCanvas {
  background: transparent;
  display: block;
  margin: auto;
  border-radius: 12px;
  z-index: 1;
  position: relative;
}
#backBtn {
  position: absolute;
  top: 12px;
  right: 12px;
  padding: 8px 12px;
  border-radius: 8px;
  background: var(--ui);
  border: none;
  cursor: pointer;
  z-index: 2;
}
#scoreDisplay {
  position: absolute;
  top: 12px;
  left: 12px;
  font-size: 20px;
  font-weight: 700;
  color: #fff;
  text-shadow: 0 2px 4px #000;
  z-index: 2;
}
</style>
</head>
<body>

<!-- INTRO -->
<div id="introPage" class="page active">
  <div class="menu-title">üéÆ Welcome to Flappy Deluxe!</div>
  <div class="card">
    <p>Get ready to flap, collect coins, and complete challenges!</p>
    <button id="startIntroBtn">Continue</button>
  </div>
</div>

<!-- MAIN MENU -->
<div id="menuPage" class="page">
  <div class="menu-title">Flappy Deluxe</div>
  <div class="card">
    <button id="playBtn">Play</button>
    <button id="storeBtn">Store</button>
    <button id="settingsBtn">Settings</button>
  </div>
</div>

<!-- STORE -->
<div id="storePage" class="page">
  <div class="menu-title">üè™ Coin Store</div>
  <div class="card">
    <p>Coins: <span id="coinCount">0</span></p>
    <p>Buy new skins and upgrades here!</p>
    <button id="buySkinBtn">Buy Fancy Skin (50 coins)</button>
  </div>
  <button id="storeBack">Back</button>
</div>

<!-- SETTINGS -->
<div id="settingsPage" class="page">
  <div class="menu-title">‚öôÔ∏è Settings</div>
  <div class="card">
    <p>Difficulty:</p>
    <select id="difficultySelect">
      <option value="easy">Easy</option>
      <option value="normal" selected>Normal</option>
      <option value="hard">Hard</option>
    </select>
  </div>
  <button id="settingsBack">Back</button>
</div>

<!-- GAME -->
<div id="gamePage" class="page">
  <canvas id="gameCanvas" width="800" height="500"></canvas>
  <button id="backBtn">Main Menu</button>
  <div id="scoreDisplay">0</div>
</div>

<script>
// --- Pages ---
const pages = {
  intro: document.getElementById('introPage'),
  menu: document.getElementById('menuPage'),
  store: document.getElementById('storePage'),
  settings: document.getElementById('settingsPage'),
  game: document.getElementById('gamePage')
};
function showPage(name) {
  Object.values(pages).forEach(p => p.classList.remove('active'));
  pages[name].classList.add('active');
}

// --- Navigation ---
document.getElementById('startIntroBtn').addEventListener('click', () => showPage('menu'));
document.getElementById('playBtn').addEventListener('click', () => { showPage('game'); startGame(); });
document.getElementById('storeBtn').addEventListener('click', () => showPage('store'));
document.getElementById('settingsBtn').addEventListener('click', () => showPage('settings'));
document.getElementById('settingsBack').addEventListener('click', () => showPage('menu'));
document.getElementById('storeBack').addEventListener('click', () => showPage('menu'));
document.getElementById('backBtn').addEventListener('click', () => { showPage('menu'); running=false; });

// --- Game Variables ---
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let width = canvas.width, height = canvas.height;
let bird, pipes, frameCount, running = false, score = 0, coins = 0;
let gravity = 0.45; // stronger physics
let difficulty = 'normal';

// --- Game Functions ---
function resetGame() {
  bird = { x: width / 4, y: height / 2, vy: 0, r: 16 };
  pipes = [];
  frameCount = 0;
  score = 0;
  document.getElementById('scoreDisplay').textContent = score;
}
function spawnPipe() {
  const gap = 130;
  const top = 60 + Math.random() * (height - gap - 120);
  pipes.push({ x: width, top, gap, passed: false });
}
function flap() { bird.vy = -8; }
window.addEventListener('keydown', e => { if (e.code === 'Space') flap(); });
canvas.addEventListener('mousedown', flap);

function startGame() {
  resetGame();
  running = true;
  requestAnimationFrame(gameLoop);
}
function gameLoop() {
  if (!running) return;
  frameCount++;
  if (frameCount % 100 === 0) spawnPipe();
  update();
  draw();
  requestAnimationFrame(gameLoop);
}
function update() {
  bird.vy += gravity;
  bird.y += bird.vy;
  pipes.forEach(p => {
    p.x -= 2;
    if (!p.passed && p.x + 60 < bird.x) {
      p.passed = true;
      score++;
      coins++;
      document.getElementById('scoreDisplay').textContent = score;
      document.getElementById('coinCount').textContent = coins;
    }
  });
  pipes = pipes.filter(p => p.x > -60);
  if (bird.y + bird.r > height - 24) gameOver();
  for (const p of pipes) {
    if (bird.x + bird.r > p.x && bird.x - bird.r < p.x + 60) {
      if (bird.y - bird.r < p.top || bird.y + bird.r > p.top + p.gap) gameOver();
    }
  }
}
function draw() {
  ctx.clearRect(0,0,width,height);
  ctx.fillStyle = "#9be7ff";
  ctx.fillRect(0,0,width,height);
  ctx.fillStyle = "#2b9a77";
  pipes.forEach(p => {
    ctx.fillRect(p.x,0,60,p.top);
    ctx.fillRect(p.x,p.top+p.gap,60,height-(p.top+p.gap)-24);
  });
  ctx.fillStyle = "#6fcf97";
  ctx.fillRect(0,height-24,width,24);
  ctx.beginPath();
  ctx.arc(bird.x,bird.y,bird.r,0,Math.PI*2);
  ctx.fillStyle = "#ffd166";
  ctx.fill();
}
function gameOver() {
  running = false;
  alert(`Game Over! Score: ${score}`);
  showPage('menu');
}
</script>
</body>
</html>
