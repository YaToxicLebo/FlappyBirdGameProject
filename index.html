<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flappy Deluxe</title>
<style>
:root{--accent:#ffd166;--muted:#64748b;--ui:#ffffffcc;}
*{box-sizing:border-box;font-family:'Segoe UI',sans-serif;margin:0;padding:0;}
body,html{height:100%;background:linear-gradient(#9be7ff,#bfeaff);overflow:hidden;}
.page{position:absolute;inset:0;display:flex;justify-content:center;align-items:center;flex-direction:column;opacity:0;pointer-events:none;transition:opacity 0.5s;}
.page.active{opacity:1;pointer-events:auto;}
button{padding:12px 24px;margin:8px;font-weight:700;border:none;border-radius:12px;cursor:pointer;transition:transform 0.2s;background:var(--accent);}
button:hover{transform:scale(1.05);}
.menu-title{font-size:2rem;margin-bottom:16px;color:#fff;text-shadow:0 3px 6px rgba(0,0,0,0.3);}
.card{background:var(--ui);padding:16px;border-radius:12px;display:flex;flex-direction:column;align-items:center;}
#skins .skin, .store-skin{width:64px;height:64px;margin:6px;border-radius:10px;cursor:pointer;display:flex;justify-content:center;align-items:center;border:2px solid transparent;position:relative;}
#skins .skin.selected, .store-skin.selected{outline:3px solid #fff;}
#skins .locked::after, .store-skin.locked::after{content:'ðŸ”’';position:absolute;top:0;right:0;font-size:20px;}
#themes .theme{width:80px;height:48px;border-radius:8px;margin:6px;cursor:pointer;display:flex;justify-content:center;align-items:center;font-weight:700;color:#111;}
#themes .theme.selected{outline:3px solid #fff;}
#gameCanvas{background:transparent;display:block;margin:auto;border-radius:12px;z-index:1;position:relative;}
#backBtn{position:absolute;top:12px;right:12px;padding:8px 12px;border-radius:8px;background:var(--ui);border:none;cursor:pointer;z-index:2;}
#scoreDisplay,#coinDisplay{position:absolute;top:12px;font-size:20px;font-weight:700;color:#fff;text-shadow:0 2px 4px #000;z-index:2;}
#scoreDisplay{left:12px;}
#coinDisplay{left:140px;}
.store-container{display:flex;flex-wrap:wrap;justify-content:center;}
.leaderboard{margin-top:12px;text-align:left;width:220px;}
</style>
</head>
<body>

<!-- MENU -->
<div id="menuPage" class="page active">
  <div class="menu-title">Flappy Deluxe</div>
  <div class="card">
    <button id="playBtn">Play</button>
    <button id="skinsBtn">Bird Skins</button>
    <button id="storeBtn">Store</button>
    <button id="settingsBtn">Settings</button>
    <button id="leaderBtn">Leaderboard</button>
  </div>
</div>

<!-- SKINS -->
<div id="skinsPage" class="page">
  <div class="menu-title">Choose Bird Skin</div>
  <div class="card" id="skins"></div>
  <button id="skinsBack">Back</button>
</div>

<!-- STORE -->
<div id="storePage" class="page">
  <div class="menu-title">Coin Store</div>
  <div class="card store-container" id="storeSkins">
    <p>Coins: <span id="coinCount">0</span></p>
    <p>Challenges Completed: <span id="challengesDone">0</span></p>
  </div>
  <button id="storeBack">Back</button>
</div>

<!-- SETTINGS -->
<div id="settingsPage" class="page">
  <div class="menu-title">Settings</div>
  <div class="card">
    <div style="margin-bottom:8px;">Background Theme</div>
    <div id="themes"></div>
  </div>
  <button id="settingsBack">Back</button>
</div>

<!-- LEADERBOARD -->
<div id="leaderPage" class="page">
  <div class="menu-title">Leaderboard</div>
  <div class="card leaderboard" id="leaderList"></div>
  <button id="leaderBack">Back</button>
</div>

<!-- GAME -->
<div id="gamePage" class="page">
  <canvas id="gameCanvas" width="800" height="500"></canvas>
  <button id="backBtn">Main Menu</button>
  <div id="scoreDisplay">Score: 0</div>
  <div id="coinDisplay">ðŸ’° 0</div>
</div>

<script>
// Pages
const pages={menu:menuPage,skins:skinsPage,store:storePage,settings:settingsPage,leader:leaderPage,game:gamePage};
function showPage(name){Object.values(pages).forEach(p=>p.classList.remove('active'));pages[name].classList.add('active');}

// Skins & Themes
const skinOptions=[
  {id:'yellow',body:'#ffd166',beak:'#ff6b6b'},
  {id:'red',body:'#ff7b9c',beak:'#ffd166'},
  {id:'blue',body:'#5eead4',beak:'#ffd166'},
  {id:'gold',body:'#ffda6a',beak:'#ffaa00',locked:true,price:50},
  {id:'galaxy',body:'linear-gradient(45deg,#6e0dd0,#00f5ff)',locked:true,price:100},
  {id:'diamond',body:'#b9f2ff',beak:'#0af',locked:true,price:200}
];
const themeOptions=[
  {id:'day',top:'#9be7ff',bottom:'#bfeaff'},
  {id:'sunset',top:'#ffb88c',bottom:'#ffecd2'},
  {id:'night',top:'#0f172a',bottom:'#071230'}
];
let settings={skin:localStorage.getItem('flappy-skin')||'yellow',theme:localStorage.getItem('flappy-theme')||'day'};
let coins=Number(localStorage.getItem('flappy-coins')||0);
let challengesDone=Number(localStorage.getItem('flappy-challenges')||0);
const coinCount=document.getElementById('coinCount');
const challengesLabel=document.getElementById('challengesDone');
coinCount.textContent=coins;
challengesLabel.textContent=challengesDone;

// Skins UI
const skinsContainer=document.getElementById('skins');
skinOptions.forEach(s=>{
  const b=document.createElement('div');b.className='skin';b.dataset.id=s.id;
  b.style.background=s.body||'#fff';
  if(s.locked&&!localStorage.getItem('unlocked-'+s.id)) b.classList.add('locked');
  b.addEventListener('click',()=>{
    if(s.locked && !localStorage.getItem('unlocked-'+s.id)){alert('Locked! Buy in store.');return;}
    settings.skin=s.id;updateUI();localStorage.setItem('flappy-skin',s.id);
  });
  skinsContainer.appendChild(b);
});
const themesContainer=document.getElementById('themes');
themeOptions.forEach(t=>{
  const b=document.createElement('div');b.className='theme';b.dataset.id=t.id;
  b.style.background=`linear-gradient(180deg,${t.top},${t.bottom})`;
  b.textContent=t.id;
  b.addEventListener('click',()=>{settings.theme=t.id;updateUI();localStorage.setItem('flappy-theme',t.id);});
  themesContainer.appendChild(b);
});
function updateUI(){
  Array.from(skinsContainer.children).forEach(c=>c.classList.toggle('selected',c.dataset.id===settings.skin));
  Array.from(themesContainer.children).forEach(c=>c.classList.toggle('selected',c.dataset.id===settings.theme));
}
updateUI();

// Store UI
const storeSkins=document.getElementById('storeSkins');
skinOptions.forEach(s=>{
  if(!s.locked) return;
  const b=document.createElement('div');b.className='store-skin';b.dataset.id=s.id;b.title=s.id+' ('+s.price+' coins)';
  b.style.background=s.body||'#fff';
  if(!localStorage.getItem('unlocked-'+s.id)) b.classList.add('locked');
  b.addEventListener('click',()=>{buySkin(s.id,s.price);updateStore();});
  storeSkins.appendChild(b);
});
function updateStore(){
  storeSkins.querySelectorAll('.store-skin').forEach(s=>{
    const id=s.dataset.id;
    s.classList.toggle('locked',!localStorage.getItem('unlocked-'+id));
  });
}

// Navigation
playBtn.onclick=()=>{showPage('game');startGame();};
skinsBtn.onclick=()=>{showPage('skins');updateUI();};
settingsBtn.onclick=()=>showPage('settings');
storeBtn.onclick=()=>
